---
layout: raw
title: CV
permalink: /cv-nicolas-betheuil/
---
<head>
    <script type="importmap">
      {
        "imports": {
          "handlebars": "https://esm.sh/handlebars",
          "date-fns": "https://esm.sh/date-fns",
          "date-fns/locale": "https://esm.sh/date-fns/locale",
          "minisearch": "https://esm.sh/minisearch"
        }
      }
    </script>
    <link rel="stylesheet" href="/jsonresume-theme-stackoverflow-main/style.css">
</head>
<body>

<div id="app">
    <div class="progress-wrapper">
        <div class="progress"></div>
    </div>
</div>
<script type="module">
    import Handlebars from 'handlebars'

    const partials = ["awards",
        "basics",
        "certificates",
        "date",
        "date-raw",
        "education",
        "interests",
        "languages",
        "projects",
        "publications",
        "references",
        "skills",
        "volunteer",
        "work"
    ].map(async p => {
        const partial = await fetch(`/jsonresume-theme-stackoverflow-main/theme/partials/${p}.hbs`).then(t => t.text())
        Handlebars.registerPartial(p, partial)
    });
    const helpers = [
        "date-helpers",
        "date-diff",
        "paragraph-split",
        "space-to-dash",
        "to-lower-case"]
        .map(async h => {
            const helper = (await import(`/jsonresume-theme-stackoverflow-main/theme/hbs-helpers/${h}.js`))
            const helperName = h.split('-').map((v, i) => {
                return (i === 0 ? v : `${v.at(0).toUpperCase()}${v.slice(1)}`)
            }).join('')
            Handlebars.registerHelper(helperName, helper[helperName])
        });

    const template = Handlebars.compile(await fetch("/jsonresume-theme-stackoverflow-main/resume.hbs").then(t => t.text()))

    const theApp = fetch('https://gist.githubusercontent.com/wadouk/5b72a9671bfb52fb28ca496f3ecde24d/raw/resume.json')
        .then(r => r.json())

    Promise.all([theApp].concat(partials).concat(helpers))
        .then(async ([resume, ...others]) => {
            document.getElementById("app").innerHTML = template({resume})

            const MiniSearch = (await import('minisearch')).default
            // Dictionnaire de synonymes
            const synonyms = {
                "scala": ["java"],
                "maven": ["java"],
                "spring": ["java"],
                "JVM": ["java"],
                "javascript": ["nodejs", "express", "vanillajs"],
                "vanillajs": ["javascript"],
                "postgis": ["postgresql"],
                "node": ["nodejs", "mocha", "jasmine"],
                "mocha": ["nodejs"],
                "express": ["nodejs"],
                "jasmine": ["nodejs", "javascript"]
            };

            // Ajout des synonymes à chaque élément
            const expandSynonyms = (text) => {
                return text.flatMap(word => [word.toLowerCase(), ...(synonyms[word.toLowerCase()] || [])]);
            };
            const minisearch = new MiniSearch({
                idField: 'id',
                fields: ['keywords'], // fields to index for full-text search
                storeFields: ['id','keywords'], // fields to return with search results
                extractField: (document, fieldName) => {
                    const v = document[fieldName]
                    if (Array.isArray(v)) {
                        let synonyms1 = expandSynonyms(v);
                        // console.log({diff: (Array.from((new Set(v.map(x => x.toLowerCase()))).symmetricDifference(new Set(synonyms1)).values()))})
                        return synonyms1.join(' ')
                    } else {
                        return v
                    }
                },
            })

            minisearch.addAll(resume.projects.map((n, j) => ({...n, id: j})))

            const projectHeader = document.querySelector("#projects").parentElement.querySelector("header .keywords")

            const keywordFilters = new Set()

            document.addEventListener('keyword', (e) => {
                if (e.has) {
                    keywordFilters.delete(e.keyword)
                    Array.from(projectHeader.querySelectorAll("li")).filter(n => e.myTarget.innerText.trim().toUpperCase() === n.innerText.trim().toUpperCase()).map(n => n.remove())
                } else {
                    keywordFilters.add(e.keyword)
                    let newNode = e.myTarget.cloneNode(true);
                    projectHeader.appendChild(newNode)
                }
                filterProjectsByKeywords()
            })

            function filterProjectsByKeywords() {
                const result = minisearch.search(Array.from(keywordFilters).join(' '))
                // console.log({result})

                Array.from(document.querySelectorAll(".project-item"))
                    .map((n, j) => {
                        n.classList[result.some(r => r.id === j) || keywordFilters.size === 0 ? "remove" : "add"]("collapse")
                    })
            }

            document.querySelector("#app").addEventListener('click', e => {
                if ("keywords" === e.target.parentElement.className) {
                    e.stopImmediatePropagation()
                    e.preventDefault()

                    let keyword = e.target.innerText;
                    const event = new Event('keyword')
                    event.keyword = keyword
                    event.has = keywordFilters.has(keyword)
                    event.myTarget = e.target
                    document.dispatchEvent(event)
                }
            })
        })


</script>

</body>